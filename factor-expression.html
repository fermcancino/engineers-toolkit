<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Factor Expression</title>
  <style>
    * {
      box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }

    body {
      margin: 0;
      background: #121212;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 10px;
      transition: background-color 0.3s, color 0.3s;
    }

    .calculator-container {
      background: linear-gradient(to bottom, #1a1a1a, #222);
      border-radius: 20px;
      padding: 20px;
      margin-bottom: 15px;
      max-width: 400px;
      width: 95%;
      border: 2px solid rgba(0, 255, 255, 0.5);
      box-shadow:
        0 0 20px rgba(0, 255, 255, 0.3),
        0 0 40px rgba(0, 255, 255, 0.2),
        0 0 60px rgba(0, 255, 255, 0.15);
      animation: glowPulse 3s ease-in-out infinite;
    }

    .topbar {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin-bottom: 0.8rem;
    }

    .topbar h1 {
      font-size: 1.2rem;
      font-weight: bold;
    }
    /* Theme Toggle */
    .switch {
      width: 50px;
      height: 28px;
      background-color: #555;
      box-shadow: 0 2px 6px rgba(255,255,255,0.15);
      border-radius: 30px;
      position: relative;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
      padding: 2px;
      cursor: pointer;
    }

    .slider {
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      transition: all 0.3s ease;
      transform: translateX(0);
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    body.light .switch {
      background: #f0f0f0;
      border: 1px solid #bbb;
      box-shadow: 0 2px 5px rgba(0,0,0,0.15);
    }

    body.light .switch .slider {
      transform: translateX(20px);
    }

    .inputs {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
      margin-bottom: 1rem;
    }

    .coeff-input {
      padding: 10px;
      font-size: 1.1rem;
      border-radius: 10px;
      background-color: #2a2a2a;
      color: white;
      border: 2px solid transparent;
      text-align: center;
      width: 100%;
    }
    .coeff-input:focus {
      outline: none !important; 
      background: #333;
      box-shadow: 0 0 5px #00bcd4;
    }

    .coeff-input.error {
      border-color: #ff8080 !important;
      box-shadow: 0 0 6px #ff8080;
      animation: shake 0.3s ease;
      transition: all 0.3s ease;
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }
    @keyframes bounce {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.12); }
    }
   
    .result {
      background: #2a2a2a;
      padding: 10px;
      border-radius: 10px;
      min-height: 60px;
      margin-bottom: 1rem;
      border: 2px solid transparent;
      box-shadow: 0 0 5px #00bcd4;
      font-size: 1rem;
    }
    .result a {
      font-size: 1rem;
      font-weight: bold;
      color: #26c6da;
    }
    body.light-theme .result b {
      color: #003973;
    }
    
    .result b {
      font-size: 1.1rem;
      color: #00e5ff;
    }

    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 8px;
    }

    .keypad button {
      padding: 15px;
      font-size: 1.1rem;
      border-radius: 10px;
      border: none;
      background: #2c2c2c;
      color: white;
      box-shadow: inset -2px -2px 4px rgba(255,255,255,0.1),
                  inset 2px 2px 4px rgba(0,0,0,0.5);
      cursor: pointer;
    }
    .keypad button:hover {
      transform: scale(1.05);
      animation: bounce 0.3s ease;
    }
    .keypad button:active {
      box-shadow: inset 2px 2px 4px #121220, inset -2px -2px 4px #3a3a50;
      transform: scale(0.97);
    }
    @keyframes bounce {
     0%, 100% { transform: scale(1); }
     50% { transform: scale(1.12); }
    }

    .solve {
      grid-column: span 3;
      background: #2c2c2c;
      color: white;
      box-shadow: inset -2px -2px 4px rgba(255,255,255,0.1),
                  inset 2px 2px 4px rgba(0,0,0,0.5);
      transition: transform 0.2s, background-color 0.2s;
      margin-bottom: 0.6rem;
    }
    .keypad .solve:active {
      box-shadow: 0 0 12px rgba(100, 255, 100, 0.8), inset 0 0 6px rgba(0,0,0,0.5);
      animation: bounce 0.3s ease;
    }
    @keyframes glowPulse {
      0%, 100% {
        box-shadow: 0 0 20px rgba(0, 255, 255, 0.3),
                    0 0 40px rgba(0, 255, 255, 0.2),
                    0 0 60px rgba(0, 255, 255, 0.15);
      }
      50% {
        box-shadow: 0 0 25px rgba(0, 255, 255, 0.5),
                    0 0 50px rgba(0, 255, 255, 0.3),
                    0 0 70px rgba(0, 255, 255, 0.2);
      }
    }

    /* Light Theme */
    body.light {
      background: #f4f4f4;
      color: #111;
    }

    body.light .calculator-container {
      background: linear-gradient(to bottom, #fff, #ddd);
    }

    body.light .coeff-input,
    body.light .result {
      background: #e0e0e0;
      color: #111;
    }

    body.light .keypad button {
      background: #ccc;
      color: #111;
    }

  </style>
</head>
<body>
  <div class="calculator-container">
    <div class="topbar">
      <h1>Factor Expression</h1>
      <div id="themeToggle" class="switch">
      <div class="slider"></div>
     </div>
    </div>

    <div class="inputs">
      <input type="number" id="a" class="coeff-input" placeholder="a (x²)"/>
      <input type="number" id="b" class="coeff-input" placeholder="b (x)"/>
      <input type="number" id="c" class="coeff-input" placeholder="c"/>
    </div>

    <div class="result" id="resultDisplay"></div>

    <div class="keypad">
      <button onclick="clearAll()">C</button>
      <button onclick="toggleSign()">±</button>
      <button onclick="backspace()">⌫</button>

      <button onclick="append('7')">7</button>
      <button onclick="append('8')">8</button>
      <button onclick="append('9')">9</button>

      <button onclick="append('4')">4</button>
      <button onclick="append('5')">5</button>
      <button onclick="append('6')">6</button>

      <button onclick="append('1')">1</button>
      <button onclick="append('2')">2</button>
      <button onclick="append('3')">3</button>

      <button onclick="append('.')">.</button>
      <button onclick="append('0')">0</button>
      <button onclick="nextInput()">→</button>

      <button class="solve" onclick="factor()">Factor</button>
    </div>
  </div>

  <script>
  const inputs = [document.getElementById("a"), document.getElementById("b"), document.getElementById("c")];
  const resultDisplay = document.getElementById("resultDisplay");
  let currentIndex = 0;

  function focusCurrent() {
    inputs.forEach((el, i) => {
      el.classList.remove("error");
      if (i === currentIndex) el.focus();
    });
  }

  inputs.forEach((input, idx) => {
    input.addEventListener("click", () => {
      currentIndex = idx;
      focusCurrent();
    });
  });

  function append(value) {
    const input = inputs[currentIndex];
    input.value += value;
  }

  function backspace() {
    const input = inputs[currentIndex];
    input.value = input.value.slice(0, -1);
  }

  function toggleSign() {
    const input = inputs[currentIndex];
    if (input.value.startsWith("-")) {
      input.value = input.value.slice(1);
    } else {
      input.value = "-" + input.value;
    }
  }

  function nextInput() {
    currentIndex = (currentIndex + 1) % 3;
    focusCurrent();
  }

  function clearAll() {
    inputs.forEach(i => i.value = "");
    resultDisplay.innerHTML = "";
    currentIndex = 0;
    focusCurrent();
  }

  function factor() {
  const a = parseInt(document.getElementById("a").value);
  const b = parseInt(document.getElementById("b").value);
  const c = parseInt(document.getElementById("c").value);
  const resultBox = document.getElementById("resultDisplay");

  inputs.forEach(input => input.classList.remove("error"));

  // Check for invalid or empty inputs
  let hasError = false;
  inputs.forEach(input => {
    if (input.value.trim() === "" || isNaN(parseFloat(input.value))) {
      input.classList.add("error");
      hasError = true;
    }
  });

  if (hasError) {
    resultBox.innerHTML = `<span style="color:#ff4d4d"> Please fill in all inputs with valid numbers.</span>`;
    resultBox.classList.add("shake");

    setTimeout(() => {
      resultBox.innerHTML = "";
      resultBox.classList.remove("shake");
      inputs.forEach(input => input.classList.remove("error"));
    }, 1500);
    return;
  }

  // Input validation
  if (isNaN(a) || isNaN(b) || isNaN(c)) {
    resultBox.innerHTML = `<span style="color:#ff4d4d">Please enter valid numbers for a, b, and c.</span>`;
    resultBox.classList.add("shake");
    setTimeout(() => resultBox.classList.remove("shake"), 300);
    return;
  }

  let output = `<a>Step 1:</a> a = ${a}, b = ${b}, c = ${c}<br>`;
  const ac = a * c;
  output += `<a>Step 2:</a> Multiply a * c = ${a} * ${c} = ${ac}<br>`;
  output += `<a>Step 3:</a> Find two numbers that multiply to ${ac} and add to ${b}<br>`;

  let found = false;
  for (let i = -Math.abs(Math.abs(ac)); i <= Math.abs(ac); i++) {
    if (i === 0) continue;
    if (ac % i === 0) {
      let j = ac / i;
      if (i + j === b) {
        output += `→ ${i} and ${j}<br>`;
        // Split middle term and factor
        output += `<a>Step 4:</a> Split the middle term:<br>`;
        output += `${a}x² + ${i}x + ${j}x + ${c}<br>`;
        // Grouping
        const g1 = gcd(a, i);
        const g2 = gcd(j, c);

        let f1 = `${g1}x(${(a/g1)}x + ${(i/g1)})`;
        let f2 = `${(j/g2)}(${(c/j)*g2 > 0 ? "" : "-"}${Math.abs(c/g2)})`;

        const binom1 = `(${a/g1}x + ${i/g1})`;
        const binom2 = `(${j/g2}x + ${c/g2})`;

        // Factoring using grouping
        const factored = factorByGrouping(a, i, j, c);

        output += `<b>Final Answer: ${factored}</b><br>`;
        found = true;
        break;
      }
    }
  }

  if (!found) {
    output += ` No integer pair found. Cannot be factored over integers.`;
  }

  resultBox.innerHTML = output;
}

// Helper: GCD
function gcd(a, b) {
  return b === 0 ? a : gcd(b, a % b);
}

// Helper: Format the factored expression
function factorByGrouping(a, i, j, c) {
  let x1 = i;
  let x2 = j;
  let group1 = gcd(a, x1);
  let group2 = gcd(x2, c);

  const binom1 = `${a / group1}x + ${x1 / group1}`;
  const binom2 = `${x2 / group2}x + ${c / group2}`;

  const factor1 = `${group1}x`;
  const factor2 = `${group2}`;

  const common = `(${binom1})`;
  if (binom1 === binom2) {
    return `(${factor1} + ${factor2})${common}`;
  } else {
    // Fall back to simplified factored form
    const r1 = -x1;
    const r2 = -x2;
    return `(x ${r1 >= 0 ? '-' : '+'} ${Math.abs(r1)})(x ${r2 >= 0 ? '-' : '+'} ${Math.abs(r2)})`;
  }
}

  // Theme toggle
    themeToggle.addEventListener("click", () => {
    document.body.classList.toggle("light");
  });

  
  inputs.forEach((input, idx) => {
  input.addEventListener("keydown", (e) => {
    // Numbers and minus
    if ((e.key >= "0" && e.key <= "9") || e.key === "-") {
      return; // allow typing
    }

    // Backspace
    if (e.key === "Backspace") {
      return; // allow deleting
    }

    // Enter → trigger factor()
    if (e.key === "Enter") {
      e.preventDefault();
      factor();
      return;
    }

    // Arrow Right or Down → next input
    if (e.key === "ArrowRight" || e.key === "ArrowDown") {
      e.preventDefault();
      currentIndex = (currentIndex + 1) % inputs.length;
      focusCurrent();
      return;
    }

    // Arrow Left or Up → previous input
    if (e.key === "ArrowLeft" || e.key === "ArrowUp") {
      e.preventDefault();
      currentIndex = (currentIndex - 1 + inputs.length) % inputs.length;
      focusCurrent();
      return;
    }

    // Block everything else
    e.preventDefault();
  });
});


  // Only disable mobile *onscreen* keyboard, but still allow hardware keys
if (window.innerWidth <= 768) {
  inputs.forEach(i => i.setAttribute("inputmode", "none")); 
} else {
  inputs.forEach(i => i.removeAttribute("inputmode"));
}

  focusCurrent();
</script>
</body>
</html>