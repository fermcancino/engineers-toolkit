<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Mixed & Improper Fraction Calculator</title>
  <style>
    * { 
      box-sizing: border-box;
      transition:background-color 0.3s, color 0.3s; 
    }

    body {
      margin: 0;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      min-height:100vh;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom, #1e1e2f, #141421);
      color: white;
      padding: 1rem;
      
    }

    .calculator-box {
      width: clamp(300px, 95%, 400px); 
      margin: 2rem auto;             
      padding: 1.5rem;
      background: #1c1c2c;
      border-radius: 20px;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.5);
    }

    .title {
      font-size: 1.3rem;
      margin-bottom: 1rem;
      text-align: center;
    }

    .fraction-row {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 0.4rem;
      flex-wrap: nowrap;
      overflow-x: auto;
      margin-bottom: 1rem;
    }

    .fraction-group {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.2rem;
    }

    .fraction-line {
      width: 42px;
      height: 2px;
      background: white;
    }

    .fraction-input {
      width: 42px;
      padding: 0.45rem;
      font-size: 1rem;
      text-align: center;
      border: 2px solid transparent;
      background: #292944;
      color: white;
      border-radius: 6px;
      transition: 0.2s;
    }

    .fraction-input:focus {
      border: 1px solid #00c6ff;
      outline: none;
      box-shadow: 0 0 5px #00bcd4;
    }

    .result-container {
      background: rgba(255, 255, 255, 0.06);
      border: 1px solid #ffffff22;
      padding: 1rem;
      margin-bottom: 1rem;
      border-radius: 12px;
      text-align: center;
      font-size: 1.1rem;
      color: #ffffffcc;
    }

    .keypad {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.5rem;
      margin-bottom: 0.5rem;
    }

    .keypad button {
      padding: 1rem;
      font-size: 1.1rem;
      border: none;
      border-radius: 12px;
      background: #2a2a3a;
      color: white;
      box-shadow: inset -3px -3px 6px #353545, inset 3px 3px 6px #1a1a28;
      transition: 0.1s;
    }

    @keyframes bounce {
     0%, 100% { transform: scale(1); }
     50% { transform: scale(1.12); }
    }
    .keypad button:hover {
      transform: scale(1.05);
      animation: bounce 0.3s ease;
    }
    .keypad button:active {
      box-shadow: inset 2px 2px 4px #121220, inset -2px -2px 4px #3a3a50;
      transform: scale(0.97);
    }

    .solve {
      grid-column: span 4;      
      color: white;
      border: none;
      border-radius: 12px;
      padding: 1rem;
      font-size: 1.1rem;
      width: 100%;
      margin: 0.6rem 0 0 0;
      display: block;
      transition: box-shadow 0.2s ease, transform 0.1s ease;
    }
    
    .keypad .solve:active {
      box-shadow: 
        0 0 10px rgba(79, 172, 254, 0.8),   
        0 0 20px rgba(0, 242, 254, 0.6),    
        0 0 35px rgba(79, 172, 254, 0.5);   
      transform: scale(0.97);
    }
    body.light .keypad .solve:active {
      box-shadow: 
        0 0 10px rgba(79, 172, 254, 0.8),   
        0 0 20px rgba(0, 242, 254, 0.6),    
        0 0 35px rgba(79, 172, 254, 0.5);  
      transform: scale(0.97);
    }


    .top-bar {
      display: flex;
      justify-content: space-around;
      align-items: center;
      margin-bottom: 1rem;
    }

    /* Theme Toggle */
    .switch {
      width: 50px;
      height: 28px;
      background: #555;              
      border-radius: 30px;
      position: relative;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
      padding: 2px;
      cursor: pointer;
    }

    .slider {
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      transition: all 0.3s ease;
      transform: translateX(0); 
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    body.light .switch {
      background: #cccccc; 
      border: 1px solid #e0e0e0; 
    }

    body.light .switch .slider {
      transform: translateX(20px); 
    }

    
    body.light {
      background: linear-gradient(to bottom, #f0f0f4, #ffffff);
      color: #1e1e2f;
    }

    body.light .calculator-box {
      background: #ffffff;
      box-shadow: 0 8px 30px rgba(0, 0, 0, 0.1);
    }
    body.light .fraction-line {
     background: black;
    }

    body.light .fraction-input {
      background: #f4f4f8;
      color: #1e1e2f;
      border: 2px solid #ccc;
    }

    body.light .fraction-input:focus {
      border: 1px solid #4facfe;
      box-shadow: 0 0 5px #00bcd4;
    }

    body.light .result-container {
      background: #f9f9fc;
      border: 1px solid #ddd;
      color: #333;
    }

    body.light .keypad button,
    body.light .solve {
      background: #e6e9ef;
      color: #222;
      box-shadow: inset -3px -3px 5px #ffffff, inset 3px 3px 5px #c5c5c5;
    }

    body.light .solve:active {
      box-shadow: inset 2px 2px 4px #c5c5c5, inset -2px -2px 4px #ffffff;
      transform: scale(0.97);
    }
  
    @media (max-width: 360px) {
      .fraction-input {
        width: 38px;
      }
      .fraction-line {
        width: 38px;
      }
    }

    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }

    .shake {
      animation: shake 0.4s ease;
    }

    .result-error {
      border: 2px solid #ff8080 !important;
      box-shadow: 
        0 0 8px rgba(255, 0, 0, 0.6),   
        0 0 16px rgba(255, 64, 64, 0.5),
        0 0 30px rgba(255, 128, 128, 0.4); 
      transition: border 0.4s ease, box-shadow 0.4s ease;
    }


    @keyframes press {
      0% { transform: scale(1); }
      50% { transform: scale(0.93); }
      100% { transform: scale(1); }
    }

    .press-animate {
      animation: press 0.15s ease;
    }
  </style>
</head>
<body>
  <div class="calculator-box">
    <div class="top-bar">
      <h1 class="title">Mixed & Improper<br>Fraction Calculator</h1>
      <div class="theme-toggle" onclick="toggleTheme()">
      <div class="switch">
      <div class="slider"></div>
      </div>
     </div>
    </div>

    <div class="fraction-row">
      <input type="text" id="whole1" class="fraction-input" placeholder="w">
      <div class="fraction-group">
        <input type="text" id="num1" class="fraction-input" placeholder="a">
        <div class="fraction-line"></div>
        <input type="text" id="den1" class="fraction-input" placeholder="b">
      </div>
      <input type="text" id="operator" class="fraction-input" placeholder="+">
      <input type="text" id="whole2" class="fraction-input" placeholder="w">
      <div class="fraction-group">
        <input type="text" id="num2" class="fraction-input" placeholder="c">
        <div class="fraction-line"></div>
        <input type="text" id="den2" class="fraction-input" placeholder="d">
      </div>
    </div>

    <div class="result-container" id="resultContainer">
      <div><strong>Result:</strong> <span id="fractionResult">—</span></div>
      <div id="decimalRow"><strong>Decimal:</strong> <span id="decimalResult">—</span></div>
    </div>

    <div class="keypad">
      <button onclick="clearAll()">C</button>
      <button onclick="toggleSign()">±</button>
      <button onclick="backspace()">⌫</button>
      <button onclick="setOperator('/')">÷</button>
      <button onclick="insert('7')">7</button>
      <button onclick="insert('8')">8</button>
      <button onclick="insert('9')">9</button>
      <button onclick="setOperator('*')">×</button>
      <button onclick="insert('4')">4</button>
      <button onclick="insert('5')">5</button>
      <button onclick="insert('6')">6</button>
      <button onclick="setOperator('-')">−</button>
      <button onclick="insert('1')">1</button>
      <button onclick="insert('2')">2</button>
      <button onclick="insert('3')">3</button>
      <button onclick="setOperator('+')">+</button>
      <button onclick="insert('.')">.</button>
      <button onclick="insert('0')">0</button>
      <button onclick="prevInput()">←</button>
      <button onclick="nextInput()">→</button>
      <button onclick="calculate()" class="solve">Solve</button>
    </div>
  </div>

  <script>
    const inputs = ['whole1', 'num1', 'den1', 'operator', 'whole2', 'num2', 'den2'];
    let focusIndex = 0;
    let userFocused = false;
    let lastInputId = 'whole1';

    function getFocused() {
      return document.getElementById(lastInputId);
    }

    function insert(val) {
      const el = getFocused();
      if (!el || el.tagName !== 'INPUT' || el.id === 'operator') return;
      if (val === '.' && el.value.includes('.')) return;
      el.value += val;
      el.focus();
    }

    function setOperator(op) {
      const el = document.getElementById("operator");
      el.value = op;
      el.focus();
      lastInputId = 'operator';
      enter();
    }

    function backspace() {
      const el = getFocused();
      if (el && el.tagName === 'INPUT' && el.id !== 'operator') {
        el.value = el.value.slice(0, -1);
      }
    }

    function toggleSign() {
      const el = getFocused();
      if (!el || el.id === 'operator') return;
      el.value = el.value.startsWith('-') ? el.value.slice(1) : '-' + el.value;
    }

    function nextInput() {
      focusIndex = (focusIndex + 1) % inputs.length;
      const next = document.getElementById(inputs[focusIndex]);
      next.focus();
      lastInputId = next.id;
    }
    function prevInput() {
      focusIndex = (focusIndex - 1 + inputs.length) % inputs.length;
      const next = document.getElementById(inputs[focusIndex]);
      next.focus();
      lastInputId = next.id;
    }
    
    function clearAll() {
      inputs.forEach(id => document.getElementById(id).value = "");
      document.getElementById("fractionResult").textContent = "—";
      document.getElementById("decimalResult").textContent = "—";
      focusIndex = 0;
      lastInputId = inputs[0];
      document.getElementById(inputs[0]).focus();
    }

    function gcd(a, b) {
      return b === 0 ? a : gcd(b, a % b);
    }

    function simplify(n, d) {
      const g = gcd(Math.abs(n), Math.abs(d));
      return [n / g, d / g];
    }

    function calculate() {
      const getVal = id => document.getElementById(id).value.trim();

      const showError = () => {
        const resultBox = document.getElementById("resultContainer");
        document.getElementById("fractionResult").textContent = `Input valid numbers`;
        document.getElementById("decimalRow").style.display = "none";
        resultBox.classList.add("shake", "result-error");
        setTimeout(() => {
          resultBox.classList.remove("shake", "result-error");
        }, 400);
      };

      const w1 = parseFloat(getVal("whole1")) || 0;
      const n1 = getVal("num1");
      const d1 = getVal("den1");

      const w2 = parseFloat(getVal("whole2")) || 0;
      const n2 = getVal("num2");
      const d2 = getVal("den2");

      const op = getVal("operator");

      if (!/^[+\-*\/]$/.test(op) || !d1 || !d2) return showError();

      const fields = [n1, d1, n2, d2];
      for (let val of fields) {
        if ((val.match(/\./g) || []).length > 1 || isNaN(val)) return showError();
      }

      const n1f = parseFloat(n1) || 0;
      const d1f = parseFloat(d1);
      const n2f = parseFloat(n2) || 0;
      const d2f = parseFloat(d2);

      let a = Math.abs(w1) * d1f + n1f;
      a = w1 < 0 ? -a : a;
      let b = d1f;

      let c = Math.abs(w2) * d2f + n2f;
      c = w2 < 0 ? -c : c;
      let d = d2f;

      let num, den;
      switch (op) {
        case '+': num = a * d + c * b; den = b * d; break;
        case '-': num = a * d - c * b; den = b * d; break;
        case '*': num = a * c; den = b * d; break;
        case '/':
          if (c === 0) return showError();
          num = a * d; den = b * c;
          break;
      }

      const [simpNum, simpDen] = simplify(num, den);
      const dec = (simpNum / simpDen).toFixed(2);

      document.getElementById("fractionResult").textContent = `${simpNum} / ${simpDen}`;
      document.getElementById("decimalResult").textContent = `${dec}`;
      document.getElementById("decimalRow").style.display = "block";
    }

    inputs.forEach(id => {
      const el = document.getElementById(id);
      el.addEventListener('focus', () => {
        focusIndex = inputs.indexOf(id);
        lastInputId = id;
        userFocused = true;
      });
    });

    window.onload = () => {
      if (!userFocused) {
        document.getElementById("whole1").focus();
        lastInputId = "whole1";
      }
    };

    function toggleTheme() {
     document.body.classList.toggle("light");
    }

    function animateButton(button) {
      button.classList.add("press-animate");
      setTimeout(() => button.classList.remove("press-animate"), 150);
    }

    document.querySelectorAll(".keypad button, .enter-button").forEach(btn => {
      btn.addEventListener("click", () => animateButton(btn));
    });
    document.addEventListener("keydown", function (e) {
  const active = document.activeElement;

  // ✅ ENTER → Solve
  if (e.key === "Enter") {
    e.preventDefault(); // stop form submission
    if (typeof calculate === "function") calculate();
  }

  // ✅ BACKSPACE → Delete last character (if input not focused normally)
  if (e.key === "Backspace" && !["INPUT", "TEXTAREA"].includes(active.tagName)) {
    e.preventDefault();
    if (typeof backspace === "function") backspace();
  }

  // ✅ ARROW KEYS → Move between inputs
  if (["ArrowLeft", "ArrowRight", "ArrowUp", "ArrowDown"].includes(e.key)) {
    const inputs = [...document.querySelectorAll(".fraction-input")];
    let index = inputs.indexOf(active);

    if (index !== -1) {
      e.preventDefault();
      if (e.key === "ArrowRight" || e.key === "ArrowDown") {
        let next = (index + 1) % inputs.length;
        inputs[next].focus();
      }
      if (e.key === "ArrowLeft" || e.key === "ArrowUp") {
        let prev = (index - 1 + inputs.length) % inputs.length;
        inputs[prev].focus();
      }
    }
  }
});

  </script>
</body>
</html>