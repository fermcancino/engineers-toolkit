<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ratio & Proportion Calculator</title>
  <style>
    * { 
      box-sizing: border-box; 
      transition:background-color 0.3s, color 0.3s;
    }

    body {
      margin: 0;
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(to bottom, #1e1e2f, #141421);
      color: white;
      padding: 1rem;
      transition: all 0.3s ease;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    body.light {
      background: linear-gradient(to bottom, #ffffff, #f0f0f8);
      color: black;
    }

    .calculator-box {
      width: clamp(280px, 95%, 400px);
      margin: auto;
      padding: 1.5rem;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 20px;
      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
      backdrop-filter: blur(15px);
      border: 1px solid rgba(255, 255, 255, 0.1);
    }

    .top-bar {
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .top-bar h1 {
      font-size: 1.5rem;
      margin: 1;
      text-align: center;
    }

    /* Theme Toggle */
    .switch {
      width: 50px;
      height: 28px;
      background: #555;              
      border-radius: 30px;
      position: relative;
      transition: background-color 0.3s ease;
      display: flex;
      align-items: center;
      padding: 2px;
      cursor: pointer;
    }


    .slider {
      width: 24px;
      height: 24px;
      background: white;
      border-radius: 50%;
      transition: all 0.3s ease;
      transform: translateX(0); 
      box-shadow: 0 2px 5px rgba(0,0,0,0.3);
    }

    body.light .switch {
      background: #cccccc; 
      border: 1px solid #e0e0e0; 
    }

    body.light .switch .slider {
      transform: translateX(20px); 
    }

    .mode-selectors {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
      flex-direction: column;
      
    }

    select {
      padding: 0.5rem;
      font-size: 1.2rem;
      border-radius: 10px;
      width: 100%;
      border: none;
      background: rgba(255, 255, 255, 0.15);
      color: #0077ff;
    }

    .light select {
      background: rgba(0, 0, 0, 0.05);
      color: black;
    }

    input {
      padding: 0.7rem;
      font-size: 1.2rem;
      width: 70px;
      max-width: 80px;
      border-radius: 10px;
      border: none;
      background: rgba(255, 255, 255, 0.15);
      color: white;
      text-align: center;
    }

    .light input {
      background: rgba(0, 0, 0, 0.05);
      color: black;
    }

    input:focus,
    input.focused {
      outline: 2px solid #00ccff;
    }

    input.result-highlight {
      background: #d0f0ff !important;
      color: black !important;
      font-weight: bold;
      outline: 2px solid #0077ff;
    }

    input:disabled {
      background-color: rgba(255, 255, 255, 0.05);
      color: gray;
      cursor: not-allowed;
    }

    .inputs.ratio,
    .inputs.proportion {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-top: 1rem;
      gap: 0.3rem;
      flex-wrap: nowrap;
    }

    .colon,
    .equals {
      font-size: 1.2rem;
    }

    .fraction-group input:first-child {
      margin-bottom: 6px;
    }

    .fraction-group input:last-child {
      margin-top: 6px;
    }

    .fraction-line {
      width: 70px;
      height: 2px;
      background: white;
    }

    .light .fraction-line {
      background: black;
    }

    .error-box {
      display: none;
      margin-top: 1rem;
      padding: 0.75rem;
      background: rgba(255, 0, 0, 0.15);
      color: #ff5555;
      box-shadow: 
        0 0 8px rgba(255, 0, 0, 0.6),   
        0 0 16px rgba(255, 64, 64, 0.5),
        0 0 30px rgba(255, 128, 128, 0.4);
      border-radius: 0.5rem;
    }

    .keypad {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 0.5rem;
      margin-top: 1rem;
    }

    .keypad button,
    .buttons button {
      padding: 1rem;
      font-size: 1.2rem;
      border-radius: 12px;
      border: 1px solid rgba(255, 255, 255, 0.2);
      background: rgba(255, 255, 255, 0.15);
      color: white;
      cursor: pointer;
      backdrop-filter: blur(8px);
      transition: 0.2s ease;
      box-shadow: inset 2px 2px 5px rgba(255, 255, 255, 0.2),
                  inset -2px -2px 5px rgba(0, 0, 0, 0.2);
    }

    .keypad button:active {
      background: rgba(255, 255, 255, 0.25);
      color: black;
      animation: bounce 0.3s ease;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
    }

    .light .keypad button,
    .light .buttons button {
      background: rgba(0, 0, 0, 0.08);
      color: black;
      border: 1px solid rgba(0, 0, 0, 0.2);
    }

    .buttons {
      display: flex;
      gap: 1rem;
      margin-top: 1rem;
    }

    .buttons button {
      flex: 1;
      border-radius: 12px;
      border: none;
      transition: box-shadow 0.2s ease, transform 0.1s ease;
      transition: background-color 0.3s;
    }

    .buttons button.calculate:active {
      box-shadow: 0 0 12px rgba(79, 172, 254, 0.8), 0 6px 18px rgba(79, 172, 254, 0.4);
      transform: translateY(-1px);
      animation: bounce 0.3s ease;
      color: black;
    }

    .buttons button.clear:active {
      background: linear-gradient(to right, #ff6b6b, #ff4e50);
      box-shadow: 0 0 12px rgba(255, 100, 100, 0.8), 0 6px 18px rgba(255, 80, 80, 0.4);
      transform: translateY(-1px);
      animation: bounce 0.3s ease;
      color: black;
    }

    .hidden {
      display: none !important;
    }

    .shake {
      animation: shake 0.3s;
    }

    .flash {
      animation: flashHighlight 0.4s ease;
    }

    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }

    @keyframes flashHighlight {
      0% { box-shadow: 0 0 0px 2px #00ccff; }
      50% { box-shadow: 0 0 10px 4px #00ccff; }
      100% { box-shadow: 0 0 0px 2px #00ccff; }
    }

    @keyframes bounce {
      0%   { transform: scale(1); }
      40%  { transform: scale(1.15); }
      60%  { transform: scale(0.95); }
      80%  { transform: scale(1.05); }
      100% { transform: scale(1); }
    }

    @media (max-width: 500px) {
      input {
        width: 65px;
        font-size: 1rem;
      }
    }
  </style>
</head>
<body>
  <div class="calculator-box">
    <div class="top-bar">
      <h1>Ratio & Proportion<br>Calculator</h1>
      <div class="switch" id="themeToggle">
      <div class="slider"></div>
     </div>
    </div>

    <div class="mode-selectors">
      <select id="mode" onchange="switchMode()">
        <option value="ratio">Ratio (a:b = c:d)</option>
        <option value="proportion">Proportion (a/b = c/d)</option>
      </select>
      <select id="type" class="hidden">
        <option value="direct">Direct Proportion</option>
        <option value="indirect">Inverse Proportion</option>
      </select>
    </div>

    <div class="inputs ratio" id="ratioInputs">
      <input type="text" id="a" placeholder="a" onclick="setFocus('a')">
      <span class="colon">:</span>
      <input type="text" id="b" placeholder="b" onclick="setFocus('b')">
      <span class="equals">=</span>
      <input type="text" id="c" placeholder="c" onclick="setFocus('c')">
      <span class="colon">:</span>
      <input type="text" id="d" placeholder="d" onclick="setFocus('d')">
    </div>

    <div class="inputs proportion hidden" id="proportionInputs">
      <div class="fraction-group">
        <input type="text" id="pa" placeholder="a" onclick="setFocus('pa')">
        <div class="fraction-line"></div>
        <input type="text" id="pb" placeholder="b" onclick="setFocus('pb')">
      </div>
      <span class="equals">=</span>
      <div class="fraction-group">
        <input type="text" id="pc" placeholder="c" onclick="setFocus('pc')">
        <div class="fraction-line"></div>
        <input type="text" id="pd" placeholder="d" onclick="setFocus('pd')">
      </div>
    </div>

    <div class="error-box" id="errorBox"></div>
    <div class="keypad" id="keypad"></div>

    <div class="buttons">
      <button class="calculate" onclick="backInput()">←</button>
      <button class="calculate" onclick="nextInput()">→</button>
      
      <button class="clear" onclick="clearAll()">Clear</button>
    </div>
  </div>

  <script>
    let currentInputId = "a";

    function setFocus(id) {
      const el = document.getElementById(id);
      if (!el.disabled) {
        currentInputId = id;
        document.querySelectorAll("input").forEach(i => i.classList.remove("focused"));
        el.classList.add("focused", "flash");
        setTimeout(() => el.classList.remove("flash"), 400);
      }
    }

    function switchMode() {
      const mode = document.getElementById("mode").value;
      document.getElementById("ratioInputs").classList.toggle("hidden", mode !== "ratio");
      document.getElementById("proportionInputs").classList.toggle("hidden", mode !== "proportion");
      document.getElementById("type").classList.toggle("hidden", mode !== "proportion");
      clearAll();
    }

    function insertKey(val) {
      const el = document.getElementById(currentInputId);
      if (!el || el.disabled) return;

      if (val === "⌫") el.value = el.value.slice(0, -1);
      else if (val === "." && el.value.includes(".")) return;
      else el.value += val;

      updateFocus();
    }

    function clearAll() {
      document.querySelectorAll("input").forEach(input => {
        input.value = "";
        input.disabled = false;
        input.classList.remove("focused", "result-highlight");
      });
      document.getElementById("errorBox").style.display = "none";

      const mode = document.getElementById("mode").value;
      currentInputId = mode === "ratio" ? "a" : "pa";
      document.getElementById(currentInputId).classList.add("focused");
    }

    function updateFocus() {
      const mode = document.getElementById("mode").value;
      const ids = mode === "ratio" ? ["a", "b", "c", "d"] : ["pa", "pb", "pc", "pd"];
      const filled = ids.filter(id => document.getElementById(id).value !== "");
      const empty = ids.filter(id => document.getElementById(id).value === "");

      ids.forEach(id => {
        const el = document.getElementById(id);
        el.disabled = false;
        el.classList.remove("result-highlight");
      });

      if (filled.length === 3 && empty.length === 1) {
        const resultBox = document.getElementById(empty[0]);
        resultBox.disabled = true;
        resultBox.classList.add("result-highlight");
        setTimeout(() => calculate(), 150);
      }
    }

    function formatValue(val) {
      const num = parseFloat(val);
      return Number.isFinite(num) ? +num.toFixed(4).replace(/\.?0+$/, '') : "";
    }

    function calculate() {
      const mode = document.getElementById("mode").value;
      const type = document.getElementById("type").value;
      const errorBox = document.getElementById("errorBox");
      errorBox.style.display = "none";

      try {
        if (mode === "ratio") {
          let a = parseFloat(document.getElementById("a").value);
          let b = parseFloat(document.getElementById("b").value);
          let c = parseFloat(document.getElementById("c").value);
          let d = parseFloat(document.getElementById("d").value);
          if ([a, b, c, d].filter(x => !isNaN(x)).length !== 3) throw "Please fill exactly 3 values in ratio";

          if (isNaN(a)) a = c * b / d;
          else if (isNaN(b)) b = a * d / c;
          else if (isNaN(c)) c = a * d / b;
          else if (isNaN(d)) d = b * c / a;

          ["a", "b", "c", "d"].forEach(id => {
            document.getElementById(id).value = formatValue(eval(id));
          });
        } else {
          let pa = parseFloat(document.getElementById("pa").value);
          let pb = parseFloat(document.getElementById("pb").value);
          let pc = parseFloat(document.getElementById("pc").value);
          let pd = parseFloat(document.getElementById("pd").value);
          let known = { pa, pb, pc, pd };
          let knownCount = Object.values(known).filter(x => !isNaN(x)).length;
          if (knownCount !== 3) throw "Please fill exactly 3 values in proportion";

          let result;
          if (type === "direct") {
            if (isNaN(pa)) result = pb * pc / pd, pa = result;
            else if (isNaN(pb)) result = pa * pd / pc, pb = result;
            else if (isNaN(pc)) result = pa * pd / pb, pc = result;
            else if (isNaN(pd)) result = pb * pc / pa, pd = result;
          } else {
            if (isNaN(pa)) result = pb * pd / pc, pa = result;
            else if (isNaN(pb)) result = pa * pc / pd, pb = result;
            else if (isNaN(pc)) result = pb * pd / pa, pc = result;
            else if (isNaN(pd)) result = pa * pc / pb, pd = result;
          }

          document.getElementById("pa").value = formatValue(pa);
          document.getElementById("pb").value = formatValue(pb);
          document.getElementById("pc").value = formatValue(pc);
          document.getElementById("pd").value = formatValue(pd);
        }
      } catch (e) {
        errorBox.textContent = e;
        errorBox.style.display = "block";
        errorBox.classList.add("shake");
        setTimeout(() => errorBox.classList.remove("shake"), 300);
      }
    }

    function nextInput() {
  const mode = document.getElementById("mode").value;
  const ids = mode === "ratio" ? ["a", "b", "c", "d"] : ["pa", "pb", "pc", "pd"];
  const currentIndex = ids.indexOf(currentInputId);

  // Clear result-highlighted input (if any)
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (el.classList.contains("result-highlight")) {
      el.value = "";
      el.disabled = false;
      el.classList.remove("result-highlight");
    }
  });

  // Hide error box
  document.getElementById("errorBox").style.display = "none";

  // Move focus to the next editable input
  for (let i = currentIndex + 1; i < ids.length; i++) {
    const el = document.getElementById(ids[i]);
    if (!el.disabled) {
      setFocus(ids[i]);
      break;
    }
  }
}

    function backInput() {
  const mode = document.getElementById("mode").value;
  const ids = mode === "ratio" ? ["a", "b", "c", "d"] : ["pa", "pb", "pc", "pd"];
  const currentIndex = ids.indexOf(currentInputId);

  // Clear result-highlighted input (if any)
  ids.forEach(id => {
    const el = document.getElementById(id);
    if (el.classList.contains("result-highlight")) {
      el.value = "";
      el.disabled = false;
      el.classList.remove("result-highlight");
    }
  });

  // Move focus to the previous editable input
  for (let i = currentIndex - 1; i >= 0; i--) {
    const el = document.getElementById(ids[i]);
    if (!el.disabled) {
      setFocus(ids[i]);
      break;
    }
  }
}

    function generateKeypad() {
      const keys = ["7", "8", "9", "4", "5", "6", "1", "2", "3", ".", "0", "⌫"];
      const keypad = document.getElementById("keypad");
      keypad.innerHTML = "";
    keys.forEach(k => {
      const btn = document.createElement("button");
      btn.textContent = k;
      btn.onclick = () => insertKey(k);
      keypad.appendChild(btn);
    });
  }
  // Trigger auto-calc whenever input changes
document.querySelectorAll("input").forEach(input => {
  input.addEventListener("input", updateFocus);
});


  document.addEventListener("DOMContentLoaded", () => {
  const themeToggle = document.getElementById("themeToggle");

  // Start in dark mode
  document.body.classList.remove("light");

  themeToggle.addEventListener("click", () => {
    document.body.classList.toggle("light");
  });

  generateKeypad();
  switchMode();
});

</script>
</body>
</html>